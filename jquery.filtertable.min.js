// Generated by CoffeeScript 1.6.1
(function(){(function(e,t){var n,r,i,s;s="filterTable";i=t.document;r={callback:null,columnSelector:"td",containerClass:"filter-table",containerTag:"p",highlightClass:"alt",inputName:"filter-table",inputPlaceholder:"search this table",inputType:"search",inputLabel:"Filter:",minRows:8,quickList:[],quickListContainerClass:"quick",quickListContainerTag:"ol",quickListItemClass:"quick",quickListItemTag:"li",rowSelector:"tbody > tr",visibleClass:"visible"};n=function(){function t(t,n){this.element=t;this.options=e.extend({},r,n);this.$element=e(this.element);this.$rows=this.$element.find(this.options.rowSelector);this.$filter_container=null;this.$quick_list_container=null;this._defaults=r;this._name=s;this.init()}t.prototype.init=function(){if(!this.$element.is("table"))return;if(this.$rows.length>=this.options.minRows){this.build_selector();this.build_filter();return this.build_quick_list()}return};t.prototype.filter_table=function(e){var t,n,r;if(e==="")this.show_all_rows();else{this.hide_all_rows();r=this.get_filter_selector(e);t=this.$rows.find(this.options.columnSelector).filter(r);t.addClass(this.options.highlightClass);n=t.closest("tr");n.show().addClass(this.options.visibleClass)}if(this.options.callback)return this.options.callback(e,this.$element)};t.prototype.show_all_rows=function(){this.$rows.show().addClass(this.options.visibleClass);return this.$rows.find("td."+this.options.highlightClass).removeClass(this.options.highlightClass)};t.prototype.hide_all_rows=function(){this.$rows.hide().removeClass(this.options.visibleClass);return this.$rows.find("td").removeClass(this.options.highlightClass)};t.prototype.get_clean_str=function(e){return e.replace(/(['"])/g,"\\$1")};t.prototype.get_filter_selector=function(e){return':filterTableFind("'+this.get_clean_str(e)+'")'};t.prototype.build_selector=function(){return e.expr[":"].filterTableFind=function(t,n,r){return e(t).text().toUpperCase().indexOf(r[3].toUpperCase())>=0}};t.prototype.build_filter_container=function(){return e("<"+this.options.containerTag+" />").addClass(this.options.containerClass)};t.prototype.build_filter_input=function(){return e("<input type='"+this.options.inputType+"' placeholder='"+this.options.inputPlaceholder+"' name='"+this.options.inputName+"' />")};t.prototype.build_filter_label=function(){if(!this.options.inputLabel)return;return e("<label for='"+this.options.inputName+"' />").html(this.options.inputLabel)};t.prototype.build_filter=function(){var t,n,r=this;this.$filter_container=this.build_filter_container();t=this.build_filter_input();n=this.build_filter_label();n&&this.$filter_container.append(n);this.$filter_container.append(t);e.fn.bindWithDelay?t.bindWithDelay("keyup",function(t){return r.filter_table(e(t.target).val())},200):t.on("keyup",function(t){return r.filter_table(e(t.target).val())});t.on("click search",function(t){return r.filter_table(e(t.target).val())});return this.$element.before(this.$filter_container)};t.prototype.build_quick_list_container=function(){return e("<"+this.options.quickListContainerTag+" />").addClass(this.options.quickListContainerClass)};t.prototype.build_quick_list_item=function(t){var n,r,i;i=t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;");n=e("<"+this.options.quickListItemTag+" />").addClass(this.options.quickListItemClass);r=e("<a href='#' />").html(i);return n.append(r)};t.prototype.build_quick_list=function(){var t,n,r,i,s,o=this;if(this.options.quickList.length>0){this.$quick_list_container=this.build_quick_list_container();s=this.options.quickList;for(r=0,i=s.length;r<i;r++){n=s[r];t=this.build_quick_list_item(n);this.$quick_list_container.append(t)}this.$quick_list_container.on("click","a",function(t){var r;t.preventDefault();n=e(t.target).html();r=o.$filter_container.find("input");return r.val(n).focus().trigger("click")});return this.$element.before(this.$quick_list_container)}return};return t}();return e.fn[s]=function(t){return this.each(function(){if(!e.data(this,"plugin_"+s))return e.data(this,"plugin_"+s,new n(this,t))})}})(jQuery,window)}).call(this);